include ../test
include ../detail

mixin test


div#detail.container

    mixin detailNav('detail')


    div(ng-repeat="f in fields",class='panel panel-default')

        div(ng-if="f.tool === 'overview'")
            div.panel-heading {{f.name}}
            div.panel-body.keyInfo
                button(ng-repeat="f in fields",ng-if="f.tool !== 'overview'", class='alert grade{{data.metrics[f.tool].grades[f.metric]}}',data-anchor="panel_{{f.metric}}")
                    span(class='badge') {{data.metrics[f.tool].grades[f.metric]}}
                    |&nbsp;{{f.name}}
                    span(ng-if="data.metrics[f.tool].data[f.metric]") &nbsp;({{format(data.metrics[f.tool].data[f.metric],f.format)}})

        div(ng-if="f.tool !== 'overview'")
            a.panelAnchor(id="panel_{{f.metric}}",name="panel_{{f.metric}}")
            div(class='panel-heading grade{{data.metrics[f.tool].grades[f.metric]}}')
                span.badge {{data.metrics[f.tool].grades[f.metric]}}
                |&nbsp;{{f.name}}
            div.panel-body.detail
                div.row
                    div.col-md-4
                        table.table.table-striped
                            tr(ng-repeat="m in fieldConfig[f.tool].items")
                                td
                                    span(class='badge grade{{getVal(data.metrics[f.tool].grades,m.metric)}}') {{getVal(data.metrics[f.tool].grades,m.metric)}}
                                td  {{m.name}}
                                td  {{format(getVal(data.metrics[f.tool].data,m.metric),m.format)}}
                    div.col-md-8
                        table.table.table-striped(ng-if="f.tool === 'time'")
                            tr(ng-repeat="m in fieldConfig[f.tool].items")
                                td
                                    span(class='badge grade{{getVal(data.metrics[f.tool].grades,m.metric)}}') {{getVal(data.metrics[f.tool].grades,m.metric)}}
                                td
                                    strong {{m.name}} - {{getInfo(data.metrics[f.tool].grades,m.metric).info}}
                                    p {{getInfo(data.metrics[f.tool].grades,m.metric).message}}


                        table.table.table-striped(ng-if="f.tool === 'yslow'")
                            tr(ng-repeat='i in data.metrics.yslow.data.g',ng-if='i.score < 100')
                                td
                                    span(class='badge grade{{i.grade}}') {{i.grade}}
                                td
                                    strong {{i.rule}}
                                    p {{i.message}}
                        table.table.table-striped(ng-if="f.tool === 'dommonster'")
                            tr(ng-repeat='i in data.metrics.dommonster.data.messages.warn')
                                td
                                    span(class='label label-danger') Danger
                                td
                                    strong {{i.string}}
                                    p {{i.hint}}
                            tr(ng-repeat='i in data.metrics.dommonster.data.messages.tip')
                                td
                                    span(class='label label-warning') Warning
                                td
                                    strong {{i.string}}
                                    p {{i.hint}}
                        table.table.table-striped(ng-if="f.tool === 'validator'")
                            tr(ng-repeat='i in data.metrics.validator.data.messages',ng-if='i.type==="error" || i.subType === "warning"')
                                td
                                    span(class='label label-danger',ng-if='i.type==="error"') Error
                                    span(class='label label-warning',ng-if='i.subType==="warning"') Warning
                                td
                                    strong {{i.lastLine}}:{{i.lastColumn}} {{i.message}}
                                    //p {{i.explanation}}