div.navbar
    button.btn.btn-primary(type="button" data-toggle="modal" data-target="#myModal") Test
div.container.table-responsive

    div(ng-controller='TestCtrl')
        div.panel.panel-default.ng-hide(ng-show="testInfo.testing")
            div.panel-heading {{testInfo.message}}
            div.panel-body
                div(class="progress progress-striped {{testInfo.status}}")
                    div.progress-bar(role="progressbar",aria-valuenow="{{testInfo.progress}}",aria-valuemin="0",aria-valuemax="100",style="width:{{testInfo.progress}}%")

        div#myModal.modal.fade(tabindex="-1",role="dialog",aria-labelledby="myModalLabel",aria-hidden="true")
            div.modal-dialog
                div.modal-content
                    div.modal-header
                        button.close(type="button",data-dismiss="modal",aria-hidden="true")
                        h4.modal-title Test
                    div.modal-body
                        form(role="form",ng-submit="test()")
                            div.form-group
                                label(for="url") URL
                                input#url.form-control(name="url",placeholder="Enter a single URL to test",ng-model="testCriteria.url")
                            button.btn.btn-default(type="button",data-dismiss="modal") Cancel
                            button.btn.btn-primary(type="submit") Go!

    table.table.table-striped
        tr
            th URL
            th Date
            th Build
            th Tag
            th.text-center Load time
            th.text-center YSlow
            th.text-center DomMonster
            th.text-center Validator
        tr.warning
            td
            td
            td
                a(href='#/report') {{query.build}}
            td
            td.text-center
                span(class="label label-{{totals.time.class}}") {{totals.time.message}} ({{totals.time.score}}%)
            td.text-center
                span(class="label label-{{totals.yslow.o.class}}") {{totals.yslow.o.message}} ({{totals.yslow.o.score}}%)
            td.text-center
                span(class="label label-{{totals.dommonster.COMPOSITE_stats.class}}") {{totals.dommonster.COMPOSITE_stats.message}} ({{totals.dommonster.COMPOSITE_stats.score}}%)
            td.text-center

        tr(ng-repeat='r in results')
            td {{r.url}}
            td {{r.timestamp | date:'shortDate'}}
            td
                a(href='#/report/:build={{r.build}}') {{r.build}}
            td {{r.tag}}
            td(class='text-center grade{{r.metrics.yslow.grades.lt}}',ng-mouseover='popover($event,{name:"time",value : r.metrics.yslow.data.lt/1000})') {{r.metrics.yslow.grades.lt}}
            td(class='text-center grade{{r.metrics.yslow.grades.o}}',ng-mouseover='popover($event,r.metrics.yslow)') {{r.metrics.yslow.grades.o}}
            td(class='text-center grade{{r.metrics.dommonster.grades.COMPOSITE_stats}}',ng-mouseover='popover($event,r.metrics.dommonster)') {{r.metrics.dommonster.grades.COMPOSITE_stats}}
            td(class='text-center grade{{r.metrics.validator.grades.COMPOSITE_info}}') {{r.metrics.validator.grades.COMPOSITE_info}}

    div#popoverContent.ng-hide
        span(ng-if='popoverContent.name === "time"') {{popoverContent.value}} s
        ul.list-group(ng-if='popoverContent.tool === "yslow"')
            li.list-group-item.active Overall&nbsp;
                span(class='badge grade{{popoverContent.grades.o}}') {{popoverContent.grades.o}}
            li.list-group-item Page Size&nbsp;
                span(class='badge grade{{popoverContent.grades.w}}') {{popoverContent.grades.w}}
            li.list-group-item Page Size (cached)&nbsp;
                span(class='badge grade{{popoverContent.grades.w_c}}') {{popoverContent.grades.w_c}}
            li.list-group-item Requests&nbsp;
                span(class='badge grade{{popoverContent.grades.r}}') {{popoverContent.grades.r}}
            li.list-group-item Requests (cached)&nbsp;
                span(class='badge grade{{popoverContent.grades.r_c}}') {{popoverContent.grades.r_c}}
            li.list-group-item Inline JS/CSS&nbsp;
                span(class='badge grade{{popoverContent.grades.yminify}}') {{popoverContent.grades.yminify}}

        ul.list-group(ng-if='popoverContent.tool === "dommonster"')
            li.list-group-item.active Overall&nbsp;
                span(class='badge grade{{popoverContent.grades.COMPOSITE_stats}}') {{popoverContent.grades.COMPOSITE_stats}}

